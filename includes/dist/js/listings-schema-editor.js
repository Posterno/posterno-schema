(function(e){function t(t){for(var a,o,r=t[0],l=t[1],c=t[2],p=0,m=[];p<r.length;p++)o=r[p],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&m.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);d&&d(t);while(m.length)m.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],a=!0,r=1;r<s.length;r++){var l=s[r];0!==i[l]&&(a=!1)}a&&(n.splice(t--,1),e=o(o.s=s[0]))}return e}var a={},i={"listings-schema-editor":0},n=[];function o(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=a,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,function(t){return e[t]}.bind(null,a));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("d479")},"08f3":function(e,t,s){},"11a5":function(e,t,s){},2650:function(e,t,s){"use strict";var a=s("847b"),i=s.n(a);i.a},"29ba":function(e,t,s){},"3f82":function(e,t,s){"use strict";var a=s("11a5"),i=s.n(a);i.a},"78af":function(e,t,s){"use strict";var a=s("29ba"),i=s.n(a);i.a},"83e5":function(e,t,s){"use strict";var a=s("08f3"),i=s.n(a);i.a},"847b":function(e,t,s){},c513:function(e,t,s){},d479:function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"pno-schema-app"}},[s("router-view")],1)},n=[],o={name:"listings-schema-editor"},r=o,l=(s("83e5"),s("2877")),c=Object(l["a"])(r,i,n,!1,null,null,null),d=c.exports,p=s("cea4"),m=s("8c4f"),h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("AdminHeader",{attrs:{links:e.adminLinks}},[e._v("\n\t\t"+e._s(e.labels.listing.title)+"\n\t")]),s("div",{staticClass:"wrapper"},[e.isError?s("wp-notice",{attrs:{type:"error",dismissible:""}},[e._v(e._s(e.statusMessage))]):e._e(),e.isSuccess?s("wp-notice",{attrs:{type:"success",dismissible:""}},[e._v(e._s(e.statusMessage))]):e._e(),s("router-link",{staticClass:"button-primary",attrs:{to:"/add"}},[e._v(e._s(e.labels.add))]),s("table",{staticClass:"wp-list-table widefat fixed striped"},[s("thead",[s("tr",[s("th",{staticClass:"column-primary",attrs:{scope:"col"}},[e._v(e._s(e.labels.table.name))]),s("th",{attrs:{scope:"col"}},[e._v(e._s(e.labels.table.mode))]),s("th",{attrs:{scope:"col"}},[e._v(e._s(e.labels.table.listing_types))]),s("th",{attrs:{scope:"col"}},[e._v(e._s(e.labels.table.actions))])])]),e.loading?s("tbody",[s("tr",{staticClass:"no-items"},[s("td",{staticClass:"colspanchange",attrs:{colspan:"4"}},[s("wp-spinner")],1)])]):!e.loading&&e.schemas<1?s("tbody",[s("tr",{staticClass:"no-items"},[s("td",{staticClass:"colspanchange",attrs:{colspan:"4"}},[s("strong",[e._v(e._s(e.labels.table.not_found))])])])]):s("tbody",e._l(e.schemas,(function(t,a){return s("tr",{key:a},[s("td",{staticClass:"column-primary",attrs:{"data-colname":e.labels.table.name}},[s("router-link",{attrs:{to:{name:"edit",params:{id:t.id}}}},[e._v(e._s(t.title))]),s("button",{staticClass:"toggle-row",attrs:{type:"button"}})],1),s("td",{attrs:{"data-colname":e.labels.table.mode}},[e._v("\n\t\t\t\t\t\t"+e._s(t.mode)+"\n\t\t\t\t\t")]),s("td",{attrs:{"data-colname":e.labels.table.listing_types}},[e._v("\n\t\t\t\t\t\t"+e._s(t.listing_types)+"\n\t\t\t\t\t")]),s("td",{attrs:{"data-colname":e.labels.table.actions}},[s("router-link",{staticClass:"button",attrs:{to:{name:"edit",params:{id:t.id}}}},[e._v(e._s(e.labels.table.edit))]),s("popper",{attrs:{trigger:"click",options:{placement:"top",modifiers:{offset:{offset:"0,10px"}}}},on:{show:function(t){return e.toggleDeleteBtn(t)},hide:function(t){return e.toggleDeleteBtn(t)}}},[s("div",{staticClass:"popper schema-delete"},[s("p",[e._v(e._s(e.labels.schema_edit.confirm_delete)+" "),s("wp-button",{attrs:{type:"primary"},on:{click:function(s){return e.deleteSchema(t.id)}}},[e._v(e._s(e.labels.table.delete))])],1)]),s("wp-button",{attrs:{slot:"reference",disabled:!e.canDelete},slot:"reference"},[e._v(e._s(e.labels.table.delete))])],1)],1)])})),0)])],1)],1)},u=[],_=(s("8e6e"),s("456d"),s("ac6a"),s("bd86")),f=(s("a481"),s("bc3a")),g=s.n(f),b=s("4328"),v=s.n(b),y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("wp-container",{attrs:{id:"pno-admin-header-wrapper"}},[s("wp-header",{staticClass:"pno-admin-title-area",attrs:{height:"auto"}},[s("wp-row",{staticClass:"wrap",attrs:{gutter:0}},[s("wp-col",{attrs:{span:16}},[s("h1",[e._t("default")],2),s("ul",{staticClass:"title-links hidden-sm-and-down"},e._l(e.links,(function(t,a){return s("li",{key:a},[s("a",{staticClass:"page-title-action",attrs:{href:t.url,target:"_blank"}},[e._v(e._s(t.title))])])})),0)]),s("wp-col",{attrs:{span:8}},[e._t("side")],2)],1)],1)],1)},w=[],S={name:"pno-admin-header",props:{links:""}},C=S,j=Object(l["a"])(C,y,w,!1,null,null,null),k=j.exports,x=s("526e"),O=s.n(x);s("a101");function E(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function L(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?E(s,!0).forEach((function(t){Object(_["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):E(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var M={name:"listings-schema-editor",components:{AdminHeader:k,popper:O.a},mounted:function(){var e=this.$route.query;e.deleted&&(this.showSuccess(this.labels.schema_edit.deleted_message),this.$router.replace(L({},this.$router.currentRoute,{query:{deleted:void 0}}))),this.loadSchemas()},data:function(){return{logo_url:pno_schema_editor.plugin_url+"/assets/imgs/logo.svg",labels:pno_schema_editor.labels,adminLinks:[{title:pno_schema_editor.labels.import,url:pno_schema_editor.import_url},{title:pno_schema_editor.labels.export,url:pno_schema_editor.export_url},{title:pno_schema_editor.labels.documentation,url:"https://docs.posterno.com/"}],loading:!1,schemas:[],isError:!1,isSuccess:!1,statusMessage:"",canDelete:!0,deleting:!1}},methods:{showError:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!1,this.isError=!0,this.isSuccess=!1,this.statusMessage=e},showSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!1,this.isError=!1,this.isSuccess=!0,this.statusMessage=e},loadSchemas:function(){var e=this;this.loading=!0,this.schemas=[];var t={nonce:pno_schema_editor.getSchemasNonce,action:"pno_get_listings_schemas_list"};g.a.get(pno_schema_editor.ajax,{params:t}).then((function(t){e.loading=!1,t.data.data.schemas.length>0&&Object.keys(t.data.data.schemas).forEach((function(s){e.schemas.push(t.data.data.schemas[s])}))})).catch((function(t){t.response.data?e.showError(t.response.data):e.showError(t.message)}))},toggleDeleteBtn:function(e){this.canDelete=!this.canDelete},deleteSchema:function(e){var t=this;this.loading=!0,g.a.post(pno_schema_editor.ajax,v.a.stringify({nonce:pno_schema_editor.deleteSchemaNonce,schema:e}),{params:{action:"pno_delete_schema"}}).then((function(e){t.toggleDeleteBtn(),t.showSuccess(t.labels.schema_edit.deleted_message),t.loadSchemas()})).catch((function(e){"undefined"!==typeof e.response&&"undefined"!==typeof e.response.data?t.showError(e.response.data):"undefined"!==typeof e.message&&t.showError(e.message)}))}}},P=M,D=(s("2650"),Object(l["a"])(P,h,u,!1,null,"bfaf1668",null)),T=D.exports,N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("AdminHeader",{attrs:{links:e.adminLinks}},[e._v("\n\t\t"+e._s(e.labels.listing.title)+"\n\t")]),s("div",{staticClass:"wrapper metabox-holder"},[s("wp-row",{staticClass:"postbox-container",attrs:{gutter:20}},[s("wp-col",{attrs:{span:12}},[s("div",{staticClass:"postbox generate-metabox start-customizing"},[s("div",{staticClass:"inside"},[s("div",{staticClass:"non-action"},[s("h1",[e._v(e._s(e.labels.structured.step1_title))]),s("div",{staticClass:"excerpt"},[s("p",[e._v(e._s(e.labels.structured.step1_description))])]),s("form",{attrs:{action:"#"}},[s("table",{staticClass:"form-table"},[s("tbody",[s("tr",[s("th",{attrs:{scope:"row"}},[e._v(e._s(e.labels.settings.where.label))]),s("td",[s("fieldset",[s("p",[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newSchemaMode,expression:"newSchemaMode"}],attrs:{name:"schema_position",type:"radio",value:"global",disabled:e.loading},domProps:{checked:e._q(e.newSchemaMode,"global")},on:{change:function(t){e.newSchemaMode="global"}}}),e._v(e._s(e.labels.settings.where.global))]),s("br"),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newSchemaMode,expression:"newSchemaMode"}],attrs:{name:"schema_position",type:"radio",value:"type",disabled:e.loading},domProps:{checked:e._q(e.newSchemaMode,"type")},on:{change:function(t){e.newSchemaMode="type"}}}),e._v(e._s(e.labels.settings.where.type))])])])])]),s("tr",[s("th",{attrs:{scope:"row"}},[e._v(e._s(e.labels.settings.schemas.label))]),s("td",[s("fieldset",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.newSchemaName,expression:"newSchemaName"}],attrs:{name:"schemaName",disabled:e.loading},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.newSchemaName=t.target.multiple?s:s[0]}}},[s("option",{attrs:{value:""}}),e._l(e.availableSchemas,(function(t,a){return s("option",{key:a,domProps:{value:t}},[e._v(e._s(t))])}))],2),s("p",{staticClass:"description"},[e._v(e._s(e.labels.settings.schemas.description))])])])]),e.isListingTypeRequired()?s("tr",[s("th",{attrs:{scope:"row"}},[e._v(e._s(e.labels.settings.listing_types.label))]),s("td",[s("fieldset",[s("Select2",{attrs:{options:e.availableListingTypes,disabled:e.loading,settings:{width:"100%",placeholder:e.labels.settings.listing_types.label,multiple:!0}},model:{value:e.newSchemaListingType,callback:function(t){e.newSchemaListingType=t},expression:"newSchemaListingType"}})],1)])]):e._e()])]),e.showNoTypesMessage()?s("wp-notice",{attrs:{type:"warning",alternative:""}},[e._v(e._s(e.labels.settings.listing_types.not_found))]):e._e()],1),e.isError?s("wp-notice",{attrs:{type:"error",alternative:""}},[e._v(e._s(e.statusMessage))]):e._e()],1),s("div",{attrs:{id:"major-publishing-actions"}},[s("div",{attrs:{id:"publishing-action"}},[e.loading?s("wp-spinner"):e._e(),s("wp-button",{attrs:{type:"primary",disabled:!e.canSubmit()},on:{click:function(t){return e.submit()}}},[e._v(e._s(e.labels.add)+" →")])],1),s("div",{staticClass:"clear"})])])])]),s("wp-col",{attrs:{span:5}},[s("div",{staticClass:"helper-list"},[s("router-link",{staticClass:"back-btn",attrs:{to:"/"}},[e._v(e._s(e.labels.back))]),s("ul",e._l(e.labels.structured.step1_lists,(function(t,a){return s("li",{key:a},[s("span",{domProps:{innerHTML:e._s(t.text)}}),t.url?s("a",{attrs:{href:t.url}},[e._v(e._s(e.labels.readmore)+" →")]):e._e()])})),0)],1)])],1)],1)],1)},$=[],A={name:"add-listings-schema",components:{AdminHeader:k},mounted:function(){var e=this;this.availableSchemas=pno_schema_editor.schema,Object.keys(pno_schema_editor.listing_types).forEach((function(t){e.availableListingTypes.push({id:t,text:pno_schema_editor.listing_types[t]})}))},data:function(){return{logo_url:pno_schema_editor.plugin_url+"/assets/imgs/logo.svg",labels:pno_schema_editor.labels,adminLinks:[{title:pno_schema_editor.labels.import,url:pno_schema_editor.import_url},{title:pno_schema_editor.labels.export,url:pno_schema_editor.export_url},{title:pno_schema_editor.labels.documentation,url:"https://docs.posterno.com/"}],newSchemaMode:"global",newSchemaName:null,newSchemaListingType:"",availableSchemas:[],availableListingTypes:[],loading:!1,isError:!1,statusMessage:""}},methods:{isListingTypeRequired:function(){var e=!1;return e="type"===this.newSchemaMode,e},canSubmit:function(){var e=!1;return"global"===this.newSchemaMode?e=!0:"type"===this.newSchemaMode&&this.availableListingTypes.length>0&&this.newSchemaListingType&&this.newSchemaListingType.length>0&&(e=!0),!0===this.loading&&(e=!1),e},showNoTypesMessage:function(){var e=!1;return"type"===this.newSchemaMode&&!this.availableListingTypes.length>0&&(e=!0),e},showError:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!1,this.isError=!0,this.statusMessage=e},submit:function(){var e=this;this.loading=!0,g.a.post(pno_schema_editor.ajax,v.a.stringify({nonce:pno_schema_editor.nonce,mode:this.newSchemaMode,schema:this.newSchemaName,types:this.newSchemaListingType}),{params:{action:"pno_create_listing_schema"}}).then((function(t){e.$router.push({name:"edit",params:{id:t.data.data}})})).catch((function(t){t.response.data?e.showError(t.response.data):e.showError(t.message)}))}}},q=A,B=(s("3f82"),Object(l["a"])(q,N,$,!1,null,null,null)),H=B.exports,F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("AdminHeader",{attrs:{links:e.adminLinks}},[e._v("\n\t\t"+e._s(e.labels.listing.title)+"\n\t")]),s("div",{staticClass:"wrap links-wrap"},[s("router-link",{staticClass:"back-btn page-title-action",attrs:{to:"/"}},[e._v(e._s(e.labels.back))]),s("router-link",{staticClass:"back-btn page-title-action",attrs:{to:"/add"}},[e._v(e._s(e.labels.add))])],1),s("div",{staticClass:"wrapper",attrs:{id:"poststuff"}},[s("wp-row",{staticClass:"postbox-container",attrs:{gutter:20}},[s("wp-col",{attrs:{span:24}},[e.isSuccess?s("wp-notice",{attrs:{type:"success",dismissible:""}},[e._v(e._s(e.statusMessage))]):e._e(),e.isError?s("wp-notice",{attrs:{type:"error",dismissible:""}},[e._v(e._s(e.statusMessage))]):e._e(),s("div",{attrs:{id:"titlediv"}},[s("div",{attrs:{id:"titlewrap"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.schema.title,expression:"schema.title"}],attrs:{type:"text",name:"post_title",size:"30",value:"",id:"title",spellcheck:"true",autocomplete:"off"},domProps:{value:e.schema.title},on:{input:function(t){t.target.composing||e.$set(e.schema,"title",t.target.value)}}})])])],1),s("wp-col",{attrs:{sm:24,lg:19}},[s("wp-tabs",{staticClass:"pno-tabs"},[s("wp-tab-item",{attrs:{label:e.labels.schema_edit.props_tab}},[s("wp-metabox",{attrs:{title:e.labels.schema_edit.title}},[e.schemaLoading?s("wp-spinner",{staticClass:"properties-spinner"}):e._e(),e.canPerformAction()||e.saving?s("jsoneditor",{ref:"editor",attrs:{json:e.schema.json,options:e.propertiesOptions}}):e._e()],1)],1),s("wp-tab-item",{attrs:{label:e.labels.schema_edit.fields}},[s("wp-metabox",{attrs:{title:e.labels.schema_edit.fields}},e._l(e.availableFields,(function(t,a){return s("div",{key:a},[s("p",[e._v(e._s(t.name)+" - "),s("code",[e._v("%_"+e._s(t.meta)+"_%")])])])})),0)],1)],1)],1),s("wp-col",{attrs:{sm:24,lg:5}},[s("wp-metabox",{attrs:{title:e.labels.schema_edit.title_edit},scopedSlots:e._u([{key:"metabox-footer",fn:function(){return[s("div",{attrs:{id:"major-publishing-actions"}},[s("div",{attrs:{id:"delete-action"}},[s("popper",{attrs:{trigger:"click","append-to-body":!0,options:{placement:"left",modifiers:{offset:{offset:"0,10px"}}}},on:{show:function(t){return e.toggleDeleteBtn(t)},hide:function(t){return e.toggleDeleteBtn(t)}}},[s("div",{staticClass:"popper schema-delete"},[s("p",[e._v(e._s(e.labels.schema_edit.confirm_delete)+" "),s("wp-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteSchema()}}},[e._v(e._s(e.labels.table.delete))])],1)]),s("wp-button",{attrs:{slot:"reference",disabled:!e.canPerformAction()||!e.canDelete},slot:"reference"},[e._v(e._s(e.labels.table.delete))])],1)],1),s("div",{attrs:{id:"publishing-action"}},[e.saving?s("wp-spinner"):e._e(),s("wp-button",{attrs:{type:"primary",disabled:!e.canPerformAction()},on:{click:function(t){return e.saveSchema()}}},[e._v(e._s(e.labels.table.save))])],1),s("div",{staticClass:"clear"})])]},proxy:!0}])},[s("form",{attrs:{action:"#"}},[s("fieldset",{staticClass:"cf-container"},[s("div",{staticClass:"cf-container__fields"},[s("div",{staticClass:"cf-field cf-radio"},[s("div",{staticClass:"cf-field__head"},[s("label",{staticClass:"cf-field__label"},[e._v(e._s(e.labels.settings.where.label))])]),s("div",{staticClass:"cf-field__body"},[s("ul",{staticClass:"cf-radio__list"},[s("li",{staticClass:"cf-radio__list-item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.schema.mode,expression:"schema.mode"}],staticClass:"cf-radio__input",attrs:{name:"schema_position",id:"global",type:"radio",value:"global",disabled:!e.canPerformAction()},domProps:{checked:e._q(e.schema.mode,"global")},on:{change:function(t){return e.$set(e.schema,"mode","global")}}}),s("label",{staticClass:"cf-radio__label",attrs:{for:"global"}},[e._v(e._s(e.labels.settings.where.global))])]),s("li",{staticClass:"cf-radio__list-item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.schema.mode,expression:"schema.mode"}],staticClass:"cf-radio__input",attrs:{name:"schema_position",id:"type",type:"radio",value:"type",disabled:!e.canPerformAction()},domProps:{checked:e._q(e.schema.mode,"type")},on:{change:function(t){return e.$set(e.schema,"mode","type")}}}),s("label",{staticClass:"cf-radio__label",attrs:{for:"type"}},[e._v(e._s(e.labels.settings.where.type))])])])])]),e.isListingTypeRequired()?s("div",{staticClass:"cf-field cf-select"},[s("div",{staticClass:"cf-field__head"},[s("label",{staticClass:"cf-field__label"},[e._v(e._s(e.labels.settings.listing_types.label))])]),s("div",{staticClass:"cf-field__body"},[s("Select2",{staticClass:"cf-select__input",attrs:{options:e.availableListingTypes,disabled:!e.canPerformAction(),settings:{width:"100%",placeholder:e.labels.settings.listing_types.label,multiple:!0}},model:{value:e.schema.listing_types,callback:function(t){e.$set(e.schema,"listing_types",t)},expression:"schema.listing_types"}})],1)]):e._e()])])])])],1)],1)],1)],1)},I=[],R=(s("7f7f"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"jsoneditor",staticClass:"pno-jsoneditor"})}),J=[],z=s("dcf5"),G=s.n(z),K=s("2ef0"),Q=s.n(K),U={name:"json-editor",data:function(){return{editor:null}},props:{json:{required:!0},options:{type:Object,default:function(){return{}}},onChange:{type:Function}},watch:{json:{handler:function(e){this.editor&&this.editor.set(e)},deep:!0}},methods:{_onChange:function(e){this.onChange&&this.editor&&this.onChange(this.editor.get())}},mounted:function(){var e=this.$refs.jsoneditor,t=Q.a.extend({onChange:this._onChange},this.options);this.editor=new G.a(e,t),this.editor.set(this.json)},beforeDestroy:function(){this.editor&&(this.editor.destroy(),this.editor=null)}},V=U,W=(s("d678"),Object(l["a"])(V,R,J,!1,null,null,null)),X=W.exports,Y=s("783b"),Z=s.n(Y),ee={name:"edit-listing-schema",components:{AdminHeader:k,popper:O.a,jsoneditor:X},mounted:function(){this.schemaID=this.$route.params.id,this.loadSchemaDetails();var e=this;this.availableSchemas=pno_schema_editor.schema,Object.keys(pno_schema_editor.listing_types).forEach((function(t){e.availableListingTypes.push({id:t,text:pno_schema_editor.listing_types[t]})}))},data:function(){return{logo_url:pno_schema_editor.plugin_url+"/assets/imgs/logo.svg",labels:pno_schema_editor.labels,adminLinks:[{title:pno_schema_editor.labels.import,url:pno_schema_editor.import_url},{title:pno_schema_editor.labels.export,url:pno_schema_editor.export_url},{title:pno_schema_editor.labels.documentation,url:"https://docs.posterno.com/"}],schemaID:"",schema:{name:"",mode:"",title:"",listing_types:[],url:"",json:""},propertiesOptions:{search:!1,colorPicker:!1,enableSort:!1,enableTransform:!1,mode:"tree",modes:["code","tree"],ajv:Z()({allErrors:!1,format:"full",unknownFormats:"ignore",verbose:!0,logger:!1})},isError:!1,isSuccess:!1,statusMessage:"",schemaLoading:!1,saving:!1,availableListingTypes:[],availableFields:[],canDelete:!0,deleting:!1}},methods:{showError:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isError=!0,this.isSuccess=!1,this.statusMessage=e},isListingTypeRequired:function(){var e=!1;return e="type"===this.schema.mode,e},loadSchemaDetails:function(){var e=this;this.schemaLoading=!0;var t={nonce:pno_schema_editor.editSchemaNonce,action:"pno_get_listing_schema",schema:this.schemaID};g.a.get(pno_schema_editor.ajax,{params:t}).then((function(t){e.schemaLoading=!1,!0===t.data.success&&(e.schema={name:t.data.data.name,mode:t.data.data.mode,listing_types:t.data.data.listing_types,title:t.data.data.title,url:t.data.data.schema_url,json:JSON.parse(t.data.data.json)},Object.keys(t.data.data.fields).forEach((function(s){e.availableFields.push({id:s,name:t.data.data.fields[s].name,meta:t.data.data.fields[s].meta})})))})).catch((function(t){e.schemaLoading=!1,"undefined"!==typeof t.response&&"undefined"!==typeof t.response.data?e.showError(t.response.data):"undefined"!==typeof t.message&&e.showError(t.message)}))},canPerformAction:function(){var e=!0;return!0===this.propertiesLoading?e=!1:!0===this.saving?e=!1:!0===this.schemaLoading&&(e=!1),e},showSuccess:function(e){this.isError=!1,this.isSuccess=!0,this.statusMessage=e},saveSchema:function(){var e=this;this.saving=!0;var t=this.$refs.editor.editor,s=t.get();g.a.post(pno_schema_editor.ajax,v.a.stringify({nonce:pno_schema_editor.saveListingSchemaNonce,post_id:this.schemaID,schema:this.schema,json:JSON.stringify(s)}),{params:{action:"pno_save_listing_schema"}}).then((function(t){e.saving=!1,!0===t.data.success&&e.showSuccess(e.labels.schema_edit.saved)})).catch((function(t){e.saving=!1,"undefined"!==typeof t.response&&"undefined"!==typeof t.response.data?e.showError(t.response.data):"undefined"!==typeof t.message&&e.showError(t.message)}))},toggleDeleteBtn:function(e){this.canDelete=!this.canDelete},deleteSchema:function(){var e=this;this.schemaLoading=!0,this.propertiesLoading=!0,g.a.post(pno_schema_editor.ajax,v.a.stringify({nonce:pno_schema_editor.deleteSchemaNonce,schema:this.schemaID}),{params:{action:"pno_delete_schema"}}).then((function(t){e.$router.push({name:"home",query:{deleted:!0}})})).catch((function(t){e.schemaLoading=!1,e.propertiesLoading=!1,"undefined"!==typeof t.response&&"undefined"!==typeof t.response.data?e.showError(t.response.data):"undefined"!==typeof t.message&&e.showError(t.message)}))}}},te=ee,se=(s("78af"),Object(l["a"])(te,F,I,!1,null,"f5a3725a",null)),ae=se.exports;a["a"].use(m["a"]);var ie=new m["a"]({routes:[{path:"/",name:"home",component:T},{path:"/add",name:"add",component:H},{path:"/edit/:id",name:"edit",component:ae}]}),ne=s("3f5b");a["a"].component("Select2",ne["a"]),a["a"].use(p["a"]),a["a"].config.productionTip=!1,new a["a"]({router:ie,render:function(e){return e(d)}}).$mount("#pno-listings-schema")},d678:function(e,t,s){"use strict";var a=s("c513"),i=s.n(a);i.a}});